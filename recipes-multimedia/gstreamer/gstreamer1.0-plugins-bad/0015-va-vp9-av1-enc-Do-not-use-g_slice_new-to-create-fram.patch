From b920ac258170c3bd9cbeb643f633c6fe8c2ee8f1 Mon Sep 17 00:00:00 2001
From: He Junyan <junyan.he@intel.com>
Date: Mon, 25 Mar 2024 15:40:52 +0800
Subject: [PATCH 015/117] va: {vp9, av1}enc: Do not use g_slice_new() to create
 frames

Part-of: <https://gitlab.freedesktop.org/gstreamer/gstreamer/-/merge_requests/6437>
---
 sys/va/gstvaav1enc.c | 2 +-
 sys/va/gstvavp9enc.c | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/sys/va/gstvaav1enc.c b/sys/va/gstvaav1enc.c
index 0cfb82844..cc959c2a9 100644
--- a/sys/va/gstvaav1enc.c
+++ b/sys/va/gstvaav1enc.c
@@ -502,7 +502,7 @@ gst_va_av1_enc_frame_new (void)
 {
   GstVaAV1EncFrame *frame;
 
-  frame = g_slice_new (GstVaAV1EncFrame);
+  frame = g_new (GstVaAV1EncFrame, 1);
   frame->frame_num = -1;
   frame->type = FRAME_TYPE_INVALID;
   frame->temporal_id = 0;
diff --git a/sys/va/gstvavp9enc.c b/sys/va/gstvavp9enc.c
index aff66453c..98780f59e 100644
--- a/sys/va/gstvavp9enc.c
+++ b/sys/va/gstvavp9enc.c
@@ -261,7 +261,7 @@ gst_va_vp9_enc_frame_new (void)
 {
   GstVaVp9EncFrame *frame;
 
-  frame = g_slice_new (GstVaVp9EncFrame);
+  frame = g_new (GstVaVp9EncFrame, 1);
   frame->frame_num = -1;
   frame->type = FRAME_TYPE_INVALID;
   frame->picture = NULL;
-- 
2.43.0

